## 第五章  基本引用类型

- 引用值（或者对象）是某个特定**引用类型的实例。**引用类型有时候也被称为**对象定义，**因为它们描述了自己的对象应有的**属性和方法。**

- **注意：** 引用类型虽然有点像类，但跟类并不是一个概念。

- **对象**被认为是某个特定**引用类型**的实例。新对象通过使用 **new 操作符**后跟一个构造函数**（constructor）**来创建。**构造函数**就是用来创建**新对象**的函数，比如下面这行代码：

```js
let now = new Date();    注意：函数也是一种引用类型。
```

### 5.1、Date

- **Date 类型**将日期保存为自协调世界时，Date 类型可以精确表示1970年1月 1日之前及之后285 616年的日期。要创建日期对象，就使用 **new 操作符**来调用 Date 构造函数：

```js
let now = new Date();
```

- 在不给 Date 构造函数**传参数**的情况下，创建的对象将保存**当前日期和时间。**要基于其他日期和时间创建日期对象，必须传入其毫秒表示，ECMAScript为此提供了两个辅助方法： **Date.parse() 和 Date.UTC() 。** 

```js
let someDate = new Date(Date.parse("May 23, 2019"));
```

- 如果传给 Date.parse() 的字符串并**不表示日期，**则该方法会**返回NaN 。**如果**直接把表示日期的字符串**传给 Date 构造函数，那么 Date **会在后台调用** Date.parse() 。换句话说，下面这行代码跟前面那行代码是等价的：

```js
let someDate = new Date("May 23, 2019");
```

- Date.UTC() 方法也返回**日期的毫秒**表示，但使用的是跟Date.parse() 不同的信息来生成这个值。传给 Date.UTC() 的参数是年、零起点月数（1月是0，2月是1，以此类推）、日（1~31）、时（0~23）、分、秒和毫秒。

```js
// GMT时间2000年1月1日零点
let y2k = new Date(Date.UTC(2000, 0));

// GMT时间2005年5月5日下午5点55分55秒 
let allFives = new Date(Date.UTC(2005, 4, 5, 17, 55, 55));
```

#### 5.1.1 继承的方法

- 与其他类型一样， Date 类型重写了 **toLocaleString() 、 toString() 和 valueOf() 方法。**但与其他类型不同，重写后这些方法的返回值不一样。 Date 类型的 **toLocaleString()** 方法返回与浏览器运行的本地环境一致的日期和时间。 **toString()** 方法通常返回带时区信息的日期和时间，而时间也是以24小时制（0~23）表示的。

```js
toLocaleString() - 2/1/2019 12:00:00 AM 

toString() - Thu Feb 1 2019 00:00:00 GMT-0800 
(Pacific Standard Time)
```

- Date 类型的 **valueOf()** 方法根本就不返回字符串，这个方法被重写后返回的是日期的毫秒表示。因此，操作符（如小于号和大于号）可以直接使用它返回的值。比如下面的例子：

```js
let date1 = new Date(2019, 0, 1); // 2019年1月1日 
let date2 = new Date(2019, 1, 1); // 2019年2月1日

console.log(date1 < date2); // true 
console.log(date1 > date2); // false
```

#### 5.1.2 日期格式化方法

- **Date 类型有几个专门用于格式化日期的方法，它们都会返回字符串：**

```js
toDateString() 显示日期中的周几、月、日、年（格式特定于实现）
toTimeString() 显示日期中的时、分、秒和时区（格式特定于实现）
toLocaleDateString() 显示日期中的周几、月、日、年（格式特定于实现和地区）
toLocaleTimeString() 显示日期中的时、分、秒（格式特定于实现）
toUTCString() 显示完整的UTC日期（格式特定于实现）

这些方法的输出与 toLocaleString() 和 toString() 一样，会因浏览器而异。因此不能用于在用户界面上一致地显示日期。
注意：还有一个方法叫toGMTString()这个方法跟toUTCString()一样，目的是为了向后兼容。不过，规范建议新代码使用toUTCString() 。
```

#### 5.1.3 日期、时间组件方法

- Date 类型剩下的方法（见下表）直接**涉及取得或设置日期值**的特定部分。注意表中**“UTC日期”，**指的是没有时区偏移（将日期转换为GMT）时的日期。

| 方法                    | 说明                                    |
| ----------------------- | --------------------------------------- |
| getTime()               | 返回日期的毫秒表示；与valueOf() 相同    |
| setTime(*milliseconds*) | 设置日期的毫秒表示，从而修改整个日期    |
| getFullYear()           | 返回4位数年返回4位数年19）              |
| getUTCFullYear()        | 返回UTC日期的4位数年                    |
| setFullYear(*year*)     | 设置日期的年（ *year* 必须是4位数）     |
| setUTCFullYear(*year*)  | 设置UTC日期的年（ *year* 必须是4位数）  |
| getMonth()              | 返回日期的月（0表示1月，11表示12月）    |
| getUTCMonth()           | 返回UTC日期的月（0表示1月，11表示12月） |

|                      |                                                       |
| -------------------- | ----------------------------------------------------- |
| setMonth(*month*)    | 设置日期的月（ *month* 为大于0的数值，大于11加年）    |
| setUTCMonth(*month*) | 设置UTC日期的月（ *month* 为大于0的数值，大于11加年） |
| getDate()            | 返回日期中的日（1~31）                                |
| getUTCDate()         | 返回UTC日期中的日（1~31）                             |
| setDate(*date*)      | 设置日期中的日（如果 *date* 大于该月天数，则加月）    |
| setUTCDate(*date*)   | 设置UTC日期中的日（如果*date* 大于该月天数，则加月）  |
| getDay()             | 返回日期中表示周几的数值（0表示周日，6表示周六）      |

|                          |                                                     |
| ------------------------ | --------------------------------------------------- |
| getUTCDay()              | 返回UTC日期中表示周几的数值（0表示周日，6表示周六） |
| getHours()               | 返回日期中的时（0~23）                              |
| getUTCHours()            | 返回UTC日期中的时（0~23）                           |
| setHours(*hours*)        | 设置日期中的时（如果 *hours*大于23，则加日）        |
| setUTCHours(*hours*)     | 设置UTC日期中的时（如果*hours* 大于23，则加日）     |
| getMinutes()             | 返回日期中的分（0~59）                              |
| getUTCMinutes()          | 返回UTC日期中的分（0~59）                           |
| setMinutes(*minutes*)    | 设置日期中的分（如果*minutes* 大于59，则加时）      |
| setUTCMinutes(*minutes*) | 设置UTC日期中的分（如果*minutes* 大于59，则加时）   |

|                                    |                                                              |
| ---------------------------------- | ------------------------------------------------------------ |
| getSeconds()                       | 返回日期中的秒（0~59）                                       |
| getUTCSeconds()                    | 返回UTC日期中的秒（0~59）                                    |
| setSeconds(*seconds*)              | 设置日期中的秒（如果*seconds* 大于59，则加分）               |
| setUTCSeconds(*seconds*)           | 设置UTC日期中的秒（如果*seconds* 大于59，则加分）            |
| getMilliseconds()                  | 返回日期中的毫秒                                             |
| getUTCMilliseconds()               | 返回UTC日期中的毫秒                                          |
| setMilliseconds(*milliseconds*)    | 设置日期中的毫秒                                             |
| setUTCMilliseconds(*milliseconds*) | 设置UTC日期中的毫秒                                          |
| getTimezoneOffset()                | 返回以分钟计的UTC与本地时区的偏移量（如美国EST即“东部标准时间”返回300，进入夏令时的地区可能有所差异） |

### 5.2 RegExp

- ECMAScript通过 RegExp 类型支持**正则表达式。**正则表达式使用**类似Perl**的简洁语法来创建：

```js
let expression = /pattern/flags;
```

- 这个正则表达式的 **pattern（模式）**可以是任何简单或复杂的正则表达式，包括**字符类、限定符、分组、向前查找和反向引用。**

```js
- g ：全局模式，表示查找字符串的全部内容，而不是找到第一个匹配的内容就结束。
- i ：不区分大小写，表示在查找匹配时忽略 pattern 和字符串的大小写。
- m ：多行模式，表示查找到一行文本末尾时会继续查找。
- y ：粘附模式，表示只查找从 lastIndex 开始及之后的字符串。
- u ：Unicode模式，启用Unicode匹配。
- s ： dotAll 模式，表示元字符 . 匹配任何字符（包括 \n 或 \r ）。
```

- 使用不同模式和标记可以创建出各种正则表达式，比如：

```js
// 匹配字符串中的所有"at" 
let pattern1 = /at/g;

// 匹配第一个"bat"或"cat"，忽略大小写
let pattern2 = /[bc]at/i;

// 匹配所有以"at"结尾的三字符组合，忽略大小写
let pattern3 = /.at/gi;
```

- 与其他语言中的正则表达式类似，所有**元字符在模式中也必须转义，**包括：

```js
( [ { \ ^ $ | ) ] } ? * + .
```

#### 5.2.1 RegExp 实例属性

- 每个 RegExp 实例都有下列属性，提供有关模式的各方面信息。

```js
- global ：布尔值，表示是否设置了 g 标记。
- ignoreCase ：布尔值，表示是否设置了 i 标记。
- unicode ：布尔值，表示是否设置了 u 标记。
- sticky ：布尔值，表示是否设置了 y 标记。
- lastIndex ：整数，表示在源字符串中下一次搜索的开始位置，始终从0开始。
- multiline ：布尔值，表示是否设置了 m 标记。
- dotAll ：布尔值，表示是否设置了 s 标记。
- source ：正则表达式的字面量字符串（不是传给构造函数的模式字符串），没有开头和结尾的斜杠。
- flags ：正则表达式的标记字符串。始终以字面量而非传入构造函数的字符串模式形式返回（没有前后斜杠）。
```

#### 5.2.2 RegExp 实例方法

- **RegExp** 实例的主要方法是 **exec() ，**主要用于**配合捕获组**使用。这个方法只接收一个参数，即要应用模式的字符串。如果找到了匹配项，则返回**包含第一个匹配信息的数组；**如果没找到匹配项，**则返回 null 。**

```js
let text = "mom and dad and baby"; 
let pattern = /mom( and dad( and baby)?)?/gi; 
let matches = pattern.exec(text); 
console.log(matches.index); // 0 
console.log(matches.input); // "mom and dad and baby
console.log(matches[0]); // "mom and dad and baby" 
console.log(matches[1]); // " and dad and baby" 
console.log(matches[2]); // " and baby"
```

- 正则表达式的另一个方法是 **test() ，**接收一个字符串参数。如果输入的文本与模式匹配，则参数返回 true ，否则返回 false 。这个方法适用于只想**测试模式**是否匹配，而不需要实际匹配内容的情况。 **test() 经常用在 if 语句中：**

```js
let text = "000-00-0000";
let pattern = /\d{3}-\d{2}-\d{4}/;
if(pattern.test(text)) {
	console.log("The pattern was matched.");
}
```

#### 5.2.3 RegExp 构造函数属性

| 全名         | 简写 | 说明                                     |
| ------------ | ---- | ---------------------------------------- |
| input        | $_   | 最后搜索的字符串                         |
| lastMatch    | $&   | 最后匹配的文本                           |
| lastParen    | $+   | 最后匹配的捕获组                         |
| leftContext  | $`   | input 字符串中出现在lastMatch 前面的文本 |
| rightContext | $'   | input 字符串中出现在lastMatch 后面的文本 |

### **5.3** 原始值包装类型

- 为了**方便操作原始值，**ECMAScript提供了3种特殊的**引用类型：Boolean 、 Number 和 String 。**每当用到某个原始值的方法或属性时，后台都会创建一个**相应原始包装类型的对象，**从而暴露出操作原始值的各种方法。来看下面的例子：

```js
let s1 = "some text"; 
let s2 = s1.substring(2);
```

- **Boolean** 是对应布尔值的**引用类型。**要创建一个 Boolean 对象，就使用 Boolean 构造函数并传入 true 或 false ，如下例所示：

```js
let booleanObject = new Boolean(true);
```

- **Number** 是对应数值的**引用类型。**要创建一个 Number 对象，就使用 Number 构造函数并传入一个数值，如下例所示：

```js
let numberObject = new Number(10);
```

- **除了继承**的方法， Number 类型还提供了几个用于将**数值格式化为字符串**的方法。**toFixed()** 方法返回包含指定小数点位数的数值字符串，如：

```js
let num = 10; 
console.log(num.toFixed(2)); // "10.00"
```

- **String** 是对应字符串的**引用类型。**要创建一个 String 对象，使用 String 构造函数并传入一个数值，如下例所示：

```js
let stringObject = new String("hello world");
```

